/* style.css - Layout Vertical Gauche + Log Droite */
:root {
    --bg-color: #1a1a2e;
    --card-bg: #16213e;
    --accent: #e94560;
    --text: #ecf0f1;
    --mp-color: #0f3460;
    --hp-color: #e94560;
    --gold: #ffd700;
}

body {
    background-color: var(--bg-color);
    color: var(--text);
    font-family: 'Roboto', sans-serif;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 10px;
    box-sizing: border-box;
    /* 1. Bloque le "Tirer pour rafraîchir" */
    overscroll-behavior-y: contain;

    /* 2. Empêche de sélectionner le texte (comme sur un doc Word) */
    user-select: none;
    -webkit-user-select: none; /* Pour Safari/iOS */
    -webkit-touch-callout: none; /* Bloque le menu contextuel au clic long */

}

/* Mise à jour du bandeau d'info pour inclure le bouton */
#game-info {
    font-family: 'Press Start 2P', cursive;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px 20px; /* Un peu moins de padding */
    border-radius: 15px;
    border: 2px solid var(--gold);
    color: var(--gold);
    margin-bottom: 20px;
    font-size: 0.8rem;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
    
    /* Flexbox pour aligner le texte et le bouton */
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
    min-width: 300px;
}

/* Style du bouton Reset */
#restart-btn {
    background: #c0392b; /* Rouge */
    border: 1px solid #e74c3c;
    color: white;
    font-family: 'Roboto', sans-serif;
    font-size: 0.7rem;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    text-transform: uppercase;
    font-weight: bold;
}

#restart-btn:hover {
    background: #e74c3c;
    box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
}

/* --- CONTENEUR PRINCIPAL --- */
.game-container {
    width: 100%;
    max-width: 1000px;
    background-color: var(--card-bg);
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    
    /* C'est ici que la magie opère : Flex Row */
    display: flex;       
    flex-direction: row;  /* Gauche vs Droite */
    align-items: stretch; /* Le log s'étire pour faire la même hauteur */
    gap: 20px;           
}

/* --- COLONNE DE GAUCHE (COMBAT) --- */
.battle-field {
    display: flex;
    flex-direction: column; /* IMPORTANT : Monstre au dessus, Héros en dessous */
    flex: 2; /* Prend environ 66% de la largeur totale */
    gap: 20px; /* Espace entre le Monstre et le Héros */
}

/* Les cartes (Monstre et Héros) prennent toute la largeur de la colonne gauche */
.character-card {
    background: rgba(255, 255, 255, 0.05);
    padding: 15px;
    border-radius: 15px;
    width: 100%; /* Remplit la colonne de gauche */
    text-align: center;
    border: 1px solid rgba(255,255,255,0.1);
    box-sizing: border-box;
}

.character-card h2 {
    margin-top: 0;
    font-family: 'Press Start 2P', cursive;
    font-size: 0.8rem;
    color: var(--gold);
    margin-bottom: 10px;
}

#enemy-sprite, #player-sprite {
    font-size: 50px;
    margin: 5px 0;
    text-shadow: 0 5px 10px rgba(0,0,0,0.5);
}

/* --- COLONNE DE DROITE (LOG) --- */
#combat-log {
    flex: 1; 
    background: #0f0f1a;
    border-radius: 10px;
    padding: 15px;
    
    /* --- CORRECTION ICI --- */
    height: 450px;       /* On fixe une hauteur de base */
    max-height: 450px;   /* On interdit de dépasser cette taille */
    overflow-y: auto;    /* La barre de scroll apparaît si le texte est trop long */
    /* -------------------- */

    font-family: 'Courier New', monospace;
    font-size: 0.8rem;
    border-left: 4px solid var(--accent);
    box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
}

#combat-log p { margin: 5px 0; border-bottom: 1px solid #222; padding-bottom: 4px; line-height: 1.3;}

/* --- BARRES --- */
.bars { width: 100%; margin-top: 5px; font-weight: bold; font-size: 0.75em;}
.bar-container {
    background-color: #000; height: 12px; width: 100%; margin: 5px 0 2px 0;
    border-radius: 6px; overflow: hidden; border: 1px solid #333; position: relative;
}
.bar { height: 100%; width: 100%; transition: width 0.4s ease-out; }
.hp { background: linear-gradient(90deg, #c0392b, #e74c3c); }
.mp { background: linear-gradient(90deg, #2980b9, #3498db); }

/* --- BOUTONS --- */
.controls {
    display: grid;
    grid-template-columns: 1fr 1fr; 
    gap: 8px;
    margin-top: 10px;
}

.skill-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.controls button, .skill-grid button {
    background: linear-gradient(180deg, #3a3a5e, #2b2b4e);
    border: 1px solid #555;
    padding: 10px;
    color: white;
    font-family: 'Roboto', sans-serif;
    font-weight: bold;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.2s;
    text-transform: uppercase;
    font-size: 0.7rem;
    width: 100%;
    min-height: 45px;
    
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
}

.controls button:hover, .skill-grid button:hover {
    background: var(--accent);
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(233, 69, 96, 0.4);
    border-color: var(--accent);
}

.controls button:disabled { opacity: 0.6; cursor: not-allowed; transform: none; box-shadow: none; }

/* --- MODALES --- */
.modal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: flex; justify-content: center; align-items: center;
    z-index: 1000; opacity: 1; transition: opacity 0.3s;
}
.modal.hidden { display: none; opacity: 0; pointer-events: none; }

.modal-content {
    background: var(--card-bg); border: 2px solid var(--gold); padding: 20px;
    border-radius: 15px; width: 90%; max-width: 450px;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); text-align: center;
}

.modal-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;
}
.modal-header h3 { margin: 0; color: var(--gold); font-family: 'Press Start 2P', cursive; font-size: 0.8rem; }

.close-btn {
    background: transparent; border: 1px solid var(--accent); color: var(--accent);
    font-weight: bold; cursor: pointer; padding: 5px 10px; border-radius: 5px;
}

/* Détails */
.detail-row { border-bottom: 1px solid rgba(255,255,255,0.1); padding: 8px 0; font-size: 0.9rem; display: flex; justify-content: space-between; }
.detail-label { color: #aaa; }
.detail-value { color: #fff; font-weight: bold; }
.detail-desc { margin-top: 15px; color: #ecf0f1; font-style: italic; }

#player-area { cursor: help; }
#player-area:active { transform: scale(0.99); }

.stat-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); font-size: 1rem; }
.stat-name { color: #bdc3c7; }
.stat-val { font-weight: bold; color: var(--gold); }

/* --- RÉCOMPENSES --- */
.reward-grid { display: flex; justify-content: center; gap: 15px; margin-top: 20px; flex-wrap: wrap; }
.reward-card {
    background: linear-gradient(180deg, #2c3e50, #000000); border: 2px solid #7f8c8d;
    border-radius: 10px; padding: 20px; width: 30%; min-width: 140px; cursor: pointer;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
}
.reward-card:hover { transform: translateY(-5px); border-color: var(--gold); }
.reward-icon { font-size: 3rem; margin-bottom: 10px; }
.reward-title { font-weight: bold; color: var(--gold); margin-bottom: 5px; font-size: 0.9rem; }
.reward-desc { font-size: 0.75rem; color: #bdc3c7; }
.rarity-tag { font-size: 0.7rem; text-transform: uppercase; font-weight: bold; margin-bottom: 5px; }

.common { border-color: #bdc3c7; } .common .rarity-tag, .common .reward-icon { color: #bdc3c7; }
.rare { border-color: #3498db; background: linear-gradient(180deg, #1a253a, #16213e); } .rare .rarity-tag, .rare .reward-icon { color: #3498db; }
.epic { border-color: #9b59b6; background: linear-gradient(180deg, #2c1a3a, #16213e); } .epic .rarity-tag, .epic .reward-icon { color: #9b59b6; }
.legendary { border-color: #f1c40f; background: linear-gradient(180deg, #3a301a, #16213e); animation: pulse-legendary 2s infinite; }
.legendary .rarity-tag, .legendary .reward-icon { color: #f1c40f; }

@keyframes pulse-legendary { 0% { box-shadow: 0 0 20px rgba(241, 196, 15, 0.6); } 50% { box-shadow: 0 0 40px rgba(241, 196, 15, 1); } 100% { box-shadow: 0 0 20px rgba(241, 196, 15, 0.6); } }

/* --- MOBILE & TABLETTE (Mode Portrait) --- */
@media (max-width: 950px) {

    body {
        /* On enlève le centrage vertical pour laisser scroller naturellement sur mobile */
        min-height: auto; 
        display: block; 
    }

    /* 1. On empile les éléments verticalement */
    .game-container {
        display: flex;
        flex-direction: column; /* Force la colonne : Combat en haut, Log en bas */
        align-items: center;
        padding: 10px;
        gap: 15px;
        max-width: 100%; /* S'assure que ça ne dépasse pas */
    }

    /* 2. La zone de combat prend toute la largeur */
    .battle-field {
        width: 100%;
        flex: none; /* Annule le ratio flexible du mode PC */
        order: 1;   /* S'assure que le combat est en PREMIER */
    }

    /* 3. Le journal de combat passe en dessous */
    #combat-log {
        width: 100%;
        flex: none;
        order: 2; /* S'assure que le log est en DEUXIÈME */
        
        /* Hauteur fixe pour éviter que ça prenne tout l'écran sur mobile */
        height: 200px;       
        min-height: 200px;
        
        margin-top: 10px;
        box-sizing: border-box; /* Important pour les bordures */
    }

    /* 4. Ajustement des cartes pour l'écran étroit */
    .character-card {
        padding: 10px;
        margin-bottom: 5px;
    }
    
    /* Le bandeau d'info (Vague / Reset) */
    #game-info {
        width: 100%;
        box-sizing: border-box;
        margin-bottom: 10px;
        flex-direction: row; /* Garde le bouton et le texte alignés */
        font-size: 0.7rem;
    }
}


    /* 4. Petits ajustements pour gagner de la place sur les petits écrans */
    #game-info {
        padding: 10px 15px;
        margin-bottom: 10px;
        width: 90%;          /* S'adapte à la largeur */
        box-sizing: border-box;
        text-align: center;
    }

    .character-card {
        padding: 10px; /* Cartes un peu plus compactes */
    }
}

.class-card-btn {
    background: linear-gradient(180deg, #2c3e50, #1a1a2e);
    border: 2px solid #7f8c8d;
    border-radius: 10px;
    padding: 20px;
    width: 200px;
    text-align: center;
    cursor: pointer;
    transition: transform 0.2s, border-color 0.2s;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

.class-card-btn:hover {
    transform: translateY(-5px);
    border-color: var(--gold);
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
}

.class-icon {
    font-size: 3rem;
    margin-bottom: 10px;
}

.class-name {
    font-family: 'Press Start 2P', cursive;
    color: var(--gold);
    font-size: 0.8rem;
    margin-bottom: 5px;
}

.class-desc {
    font-size: 0.7rem;
    color: #bdc3c7;
    line-height: 1.4;
}


/* --- style.css --- */

/* Style du bouton Reroll */
.reroll-btn {
    background: linear-gradient(180deg, #d35400, #e67e22); /* Orange risque */
    border: 2px solid #f39c12;
    color: white;
    font-family: 'Press Start 2P', cursive; /* Style rétro */
    font-size: 0.7rem;
    padding: 15px 30px;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 0 #a04000; /* Effet 3D */
    transition: transform 0.1s, box-shadow 0.1s;
    text-transform: uppercase;
    line-height: 1.5;
}

.reroll-btn:hover {
    background: linear-gradient(180deg, #e67e22, #f39c12);
    transform: translateY(2px); /* Effet d'appui */
    box-shadow: 0 2px 0 #a04000;
}

.reroll-btn:active {
    transform: translateY(4px);
    box-shadow: none;
}

.reroll-btn small {
    display: block;
    font-family: 'Roboto', sans-serif;
    font-size: 0.6rem;
    margin-top: 5px;
    opacity: 0.9;
    text-transform: none;
}


/* --- EFFETS VISUELS (Juice) --- */

/* 1. Texte Flottant (Dégâts) */
.floating-text {
    position: absolute;
    font-family: 'Press Start 2P', cursive;
    font-weight: bold;
    font-size: 1.5rem; /* Gros chiffres ! */
    pointer-events: none; /* Permet de cliquer à travers */
    z-index: 9999;
    text-shadow: 2px 2px 0 #000; /* Contour noir pour lisibilité */
    animation: floatUp 0.8s ease-out forwards; /* L'animation dure 0.8s */
}

/* L'animation qui fait monter le texte et disparaître */
@keyframes floatUp {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    20% { transform: translateY(-20px) scale(1.5); opacity: 1; } /* Petit effet de "pop" */
    100% { transform: translateY(-80px) scale(1); opacity: 0; }
}

/* Couleurs selon le type */
.color-physique { color: #e74c3c; } /* Rouge */
.color-magique { color: #9b59b6; }  /* Violet */
.color-feu { color: #e67e22; }      /* Orange */
.color-eau { color: #3498db; }      /* Bleu */
.color-terre { color: #27ae60; }    /* Vert Fonce */
.color-electrique { color: #f1c40f; } /* Jaune */
.color-lumiere { color: #fffacd; text-shadow: 0 0 5px #f1c40f; } /* Brillant */
.color-tenebres { color: #8e44ad; } /* Violet foncé */
.color-soin { color: #2ecc71; }     /* Vert clair */


/* 2. Animation de Secousse (Quand on est touché) */
.shake-anim {
    animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
}

@keyframes shake {
    10%, 90% { transform: translate3d(-2px, 0, 0); }
    20%, 80% { transform: translate3d(4px, 0, 0); }
    30%, 50%, 70% { transform: translate3d(-6px, 0, 0); }
    40%, 60% { transform: translate3d(6px, 0, 0); }
}

/* 3. Animation d'Attaque (Bond vers l'avant) */
/* Pour le héros (vers la droite/haut si desktop/mobile) */
.attack-hero { animation: lungeRight 0.2s ease-in-out; }
@keyframes lungeRight { 
    0% { transform: translateX(0); } 
    50% { transform: translateX(30px); } 
    100% { transform: translateX(0); } 
}

/* Pour le monstre (vers la gauche) */
.attack-enemy { animation: lungeLeft 0.2s ease-in-out; }
@keyframes lungeLeft { 
    0% { transform: translateX(0); } 
    50% { transform: translateX(-30px); } 
    100% { transform: translateX(0); } 
}

/* Flash Rouge (Quand on prend des dégâts critiques ou forts) */
.flash-red {
    animation: flashRed 0.3s;
}
@keyframes flashRed {
    0% { filter: none; }
    50% { filter: sepia(1) saturate(5) hue-rotate(-50deg); } /* Filtre rouge */
    100% { filter: none; }
}

/* --- Ajout dans style.css --- */

/* Conteneur des icônes d'effets (Buffs/Debuffs) */
.status-effects-container {
    display: flex;
    justify-content: center;
    gap: 5px;
    margin-top: 5px;
    min-height: 24px; /* Garde la place même si vide */
    flex-wrap: wrap;
}

/* L'icône individuelle */
.status-icon {
    font-size: 0.8rem;
    padding: 2px 5px;
    border-radius: 4px;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid #555;
    cursor: help;
    position: relative;
    font-family: 'Roboto', sans-serif;
    font-weight: bold;
}

/* Couleurs selon le type d'effet (optionnel mais joli) */
.status-icon.buff { border-color: #2ecc71; color: #2ecc71; } /* Vert */
.status-icon.debuff { border-color: #e74c3c; color: #e74c3c; } /* Rouge */
